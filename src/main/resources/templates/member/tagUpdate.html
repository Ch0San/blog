<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>태그 관리</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>

<body>
    <!-- 공통 헤더 import -->
    <div th:replace="~{fragments/header :: header('home')}"></div>

    <main class="container" style="padding-top:28px">
        <div class="write-form" style="max-width:600px">
            <h1 style="margin:0 0 24px;color:var(--text)">태그 관리</h1>

            <form th:action="@{/member/tag-update}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <div class="form-group">
                    <label for="tags">태그 목록</label>
                    <p style="color:var(--muted);font-size:13px;margin:4px 0 8px">쉼표(,)로 구분하여 입력하세요. 예: Java, Spring,
                        MyBatis</p>
                    <textarea id="tags" name="tags" th:text="${tags}"
                        placeholder="Java, Spring, MyBatis, React, Node.js" style="min-height:150px"></textarea>
                </div>

                <div class="form-group">
                    <label>현재 태그 미리보기</label>
                    <div id="tagPreview"
                        style="display:flex;flex-wrap:wrap;gap:8px;padding:16px;background:#f9fafb;border-radius:8px;border:1px solid #e6e9ee;min-height:60px">
                        <span th:each="tag : ${#strings.arraySplit(tags, ',')}"
                            th:if="${!#strings.isEmpty(#strings.trim(tag))}"
                            style="background:#e6f7ed;padding:6px 12px;border-radius:16px;color:var(--accent);font-size:13px">
                            <span th:text="'#' + ${#strings.trim(tag)}"></span>
                        </span>
                    </div>
                </div>

                <div class="form-actions">
                    <a href="/" class="btn btn-secondary">취소</a>
                    <button type="submit" class="btn btn-primary">저장</button>
                </div>
            </form>
        </div>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>

    <script>
        // 실시간 미리보기
        document.getElementById('tags').addEventListener('input', function (e) {
            const tags = e.target.value.split(',').map(t => t.trim()).filter(t => t.length > 0);
            const preview = document.getElementById('tagPreview');

            if (tags.length === 0) {
                preview.innerHTML = '<span style="color:var(--muted);font-size:13px">태그를 입력하세요</span>';
                return;
            }

            preview.innerHTML = tags.map(tag =>
                `<span style="background:#e6f7ed;padding:6px 12px;border-radius:16px;color:var(--accent);font-size:13px">#${tag}</span>`
            ).join('');
        });
    </script>
</body>

</html>